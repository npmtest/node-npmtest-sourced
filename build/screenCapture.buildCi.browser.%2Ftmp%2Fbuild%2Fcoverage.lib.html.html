<html lang="en"><head>
    <title>Code coverage report for node-npmtest-sourced/node_modules/sourced/lib/entity.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-sourced">npmtest-sourced (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-sourced/node_modules/sourced/lib/entity.js</span></h1>
    <h2>
        
        Statements: <span class="metric">22.58% <small>(21 / 93)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 36)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 14)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">23.86% <small>(21 / 88)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> » <a href="index.html">node-npmtest-sourced/node_modules/sourced/lib/</a> » entity.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tbody><tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/* jslint node: true */
&nbsp;
var events = require('events');
var log = require('debug')('sourced');
var util = require('util');
var _ = require('lodash');
&nbsp;
/**
 * Extending native Error.
 *
 * @class {Function} EntityError
 * @param {String} msg The error message.
 * @param {Object} [constr=this] The constructor or instance.
 */
<span class="fstat-no" title="function not covered">function EntityError (msg, constr) {</span>
<span class="cstat-no" title="statement not covered">  Error.captureStackTrace(this, constr || this);</span>
<span class="cstat-no" title="statement not covered">  this.message = msg || 'Entity Error';</span>
}
&nbsp;
util.inherits(EntityError, Error);
&nbsp;
EntityError.prototype.name = 'EntityError';
&nbsp;
/**
 * Creates an event-sourced Entity.
 *
 * @class {Function} Entity
 * @param {Object} [snapshot] A previously saved snapshot of an entity.
 * @param {Array} [events] An array of events to apply on instantiation.
 * @requires events
 * @requires debug
 * @requires util
 * @requires lodash
 * @license MIT
 */
<span class="fstat-no" title="function not covered">function Entity (/*snapshot, evnts*/) {</span>
&nbsp;
  /**
   * [Description]
   *
   * @member {Array} eventsToEmit
   * @todo discuss the use of this so it can be documented better.
   */
<span class="cstat-no" title="statement not covered">  this.eventsToEmit = [];</span>
&nbsp;
  /**
   * [Description]
   *
   * @member {Array} newEvents
   * @todo discuss the use of this so it can be documented better.
   */
<span class="cstat-no" title="statement not covered">  this.newEvents = [];</span>
&nbsp;
  /**
   * Boolean to prevent emit, enqueue and digest from running during replay.
   *
   * @member {Boolean} replaying
   */
<span class="cstat-no" title="statement not covered">  this.replaying = false;</span>
&nbsp;
  /**
   * Holds the version of the latest snapshot for the entity.
   *
   * @member {Number} snapshotVersion
   */
<span class="cstat-no" title="statement not covered">  this.snapshotVersion = 0;</span>
&nbsp;
  /**
   * Holds the event's timestamp in the entity.
   *
   * @member {Number} timestamp
   */
<span class="cstat-no" title="statement not covered">  this.timestamp = Date.now();</span>
&nbsp;
  /**
   * Holds the current version of the entity.
   *
   * @member {Number} version
   */
<span class="cstat-no" title="statement not covered">  this.version = 0;</span>
&nbsp;
<span class="cstat-no" title="statement not covered">  events.EventEmitter.call(this);</span>
<span class="cstat-no" title="statement not covered">  var args = Array.prototype.slice.call(arguments);</span>
&nbsp;
  /**
   * If one argument is passed, asume it's a snapshot and merge it.
   *
   * @todo This should probably be changed. What if it's not a snapshot/object?
   */
<span class="cstat-no" title="statement not covered">  if (args[0]){</span>
<span class="cstat-no" title="statement not covered">    var snapshot = args[0];</span>
<span class="cstat-no" title="statement not covered">    this.merge(snapshot);</span>
  }
&nbsp;
  /**
   * If two arguments are passed, asume the second is an array of events and
   * replay them.
   *
   * @todo This should probably be changed. What if it's not an array?
   */
<span class="cstat-no" title="statement not covered">  if (args[1]){</span>
<span class="cstat-no" title="statement not covered">    var evnts = args[1];</span>
<span class="cstat-no" title="statement not covered">    this.replay(evnts);</span>
  }
}
&nbsp;
util.inherits(Entity, events.EventEmitter);
&nbsp;
/**
 * Wrapper around the EventEmitter.emit method that adds a condition so events
 * are not fired during replay.
 */
Entity.prototype.emit = <span class="fstat-no" title="function not covered">function emit () {</span>
<span class="cstat-no" title="statement not covered">  if ( ! this.replaying) {</span>
<span class="cstat-no" title="statement not covered">    events.EventEmitter.prototype.emit.apply(this, arguments);</span>
  }
};
&nbsp;
/**
 * Add events to the queue of events to emit. If called during replay, this
 * method does nothing.
 */
Entity.prototype.enqueue = <span class="fstat-no" title="function not covered">function enqueue () {</span>
<span class="cstat-no" title="statement not covered">  if ( ! this.replaying) {</span>
<span class="cstat-no" title="statement not covered">    this.eventsToEmit.push(arguments);</span>
  }
};
&nbsp;
/**
 * Digest a command with given data.This is called whenever you want to record
 * a command into the events for the entity. If called during replay, this
 * method does nothing.
 *
 * @param  {String} method  the name of the method/command you want to digest.
 * @param  {Object} data    the data that should be passed to the replay.
 */
Entity.prototype.digest = <span class="fstat-no" title="function not covered">function digest (method, data) {</span>
<span class="cstat-no" title="statement not covered">  if( ! this.replaying) {</span>
<span class="cstat-no" title="statement not covered">    this.timestamp = Date.now();</span>
<span class="cstat-no" title="statement not covered">    this.version = this.version + 1;</span>
<span class="cstat-no" title="statement not covered">    log(util.format('digesting event \'%s\' w/ data %j', method, data));</span>
<span class="cstat-no" title="statement not covered">    this.newEvents.push({</span>
      method: method,
      data: data,
      timestamp: this.timestamp,
      version: this.version
    });
  }
};
&nbsp;
/**
 * Merge a snapshot onto the entity.
 *
 * For every property passed in the snapshot, the value is deep-cloned and then
 * merged into the instance through mergeProperty. See mergeProperty for details.
 *
 * @param  {Object} snapshot  snapshot object.
 * @see Entity.prototype.mergeProperty
 */
Entity.prototype.merge = <span class="fstat-no" title="function not covered">function merge (snapshot) {</span>
<span class="cstat-no" title="statement not covered">  log(util.format('merging snapshot %j', snapshot));</span>
<span class="cstat-no" title="statement not covered">  for (var property in snapshot) {</span>
<span class="cstat-no" title="statement not covered">    if (snapshot.hasOwnProperty(property))</span>
<span class="cstat-no" title="statement not covered">      var val = _.cloneDeep(snapshot[property]);</span>
<span class="cstat-no" title="statement not covered">      this.mergeProperty(property, val);</span>
  }
<span class="cstat-no" title="statement not covered">  return this;</span>
};
&nbsp;
/**
 * Merge a property onto the instance.
 *
 * Given a name and a value, mergeProperty checks first attempt to find the
 * property in the mergeProperties map using the constructor name as key. If it
 * is found and it is a function, the function is called. If it is NOT found
 * we check if the property is an object. If so, we merge. If not, we simply
 * assign the passed value to the instance.
 *
 * @param  {String} name   the name of the property being merged.
 * @param  {Object} value  the value of the property being merged.
 * @see mergeProperties
 * @see Entity.mergeProperty
 */
Entity.prototype.mergeProperty = <span class="fstat-no" title="function not covered">function mergeProperty (name, value) {</span>
<span class="cstat-no" title="statement not covered">  if (mergeProperties.size &amp;&amp;</span>
      mergeProperties.has(this.__proto__.constructor.name) &amp;&amp;
      mergeProperties.get(this.__proto__.constructor.name).has(name) &amp;&amp;
      typeof mergeProperties.get(this.__proto__.constructor.name).get(name) === 'function') {
<span class="cstat-no" title="statement not covered">    return mergeProperties.get(this.__proto__.constructor.name).get(name).call(this, value);</span>
  }
  else <span class="cstat-no" title="statement not covered">if (typeof value === 'object' &amp;&amp; typeof this[name] === 'object') <span class="cstat-no" title="statement not covered">_.merge(this[name], value);</span></span>
  else <span class="cstat-no" title="statement not covered">this[name] = value;</span>
};
&nbsp;
/**
 * Replay an array of events onto the instance.
 *
 * The goal here is to allow application of events without emitting, enqueueing
 * nor digesting the replayed events. This is done by setting this.replaying to
 * true which emit, enqueue and digest check for.
 *
 * If the method in the event being replayed exists in the instance, we call
 * the mathod with the data in the event and set the version of the instance to
 * the version of the event. If the method is not found, we attempt to parse the
 * constructor to give a more descriptive error.
 *
 * @param  {Array} events  an array of events to be replayed.
 */
Entity.prototype.replay = <span class="fstat-no" title="function not covered">function replay (events) {</span>
<span class="cstat-no" title="statement not covered">  var self = this;</span>
&nbsp;
<span class="cstat-no" title="statement not covered">  this.replaying = true;</span>
&nbsp;
<span class="cstat-no" title="statement not covered">  log(util.format('replaying events %j', events));</span>
&nbsp;
<span class="cstat-no" title="statement not covered">  events.forEach(<span class="fstat-no" title="function not covered">function (event) {</span></span>
<span class="cstat-no" title="statement not covered">    if (self[event.method]) {</span>
<span class="cstat-no" title="statement not covered">      self[event.method](event.data);</span>
<span class="cstat-no" title="statement not covered">      self.version = event.version;</span>
    } else {
<span class="cstat-no" title="statement not covered">      var classNameRegex = /function (.{1,})\w?\(/,</span>
          className = classNameRegex.exec(self.constructor.toString())[1],
          errorMessage = util.format('method \'%s\' does not exist on model \'%s\'', event.method, className);
<span class="cstat-no" title="statement not covered">      log(errorMessage);</span>
<span class="cstat-no" title="statement not covered">      throw new EntityError(errorMessage);</span>
    }
  });
&nbsp;
<span class="cstat-no" title="statement not covered">  this.replaying = false;</span>
};
&nbsp;
/**
 * Create a snapshot of the current state of the entity instance.
 *
 * Here the instance's snapshotVersion property is set to the current version,
 * then the instance is deep-cloned and the clone is trimmed of the internal
 * sourced attributes using trimSnapshot and returned.
 *
 * @returns  {Object}
 */
Entity.prototype.snapshot = <span class="fstat-no" title="function not covered">function snapshot () {</span>
<span class="cstat-no" title="statement not covered">  this.snapshotVersion = this.version;</span>
<span class="cstat-no" title="statement not covered">  var snap = _.cloneDeep(this, true);</span>
<span class="cstat-no" title="statement not covered">  return this.trimSnapshot(snap);</span>
};
&nbsp;
/**
 * Remove the internal sourced properties from the passed snapshot.
 *
 * Snapshots are to contain only entity data properties. This trims all other
 * properties from the snapshot.
 *
 * @param  {Object} snapshot  the snapshot to be trimmed.
 * @see Entity.prototype.snapshot
 */
Entity.prototype.trimSnapshot = <span class="fstat-no" title="function not covered">function trimSnapshot (snapshot) {</span>
<span class="cstat-no" title="statement not covered">  delete snapshot.eventsToEmit;</span>
<span class="cstat-no" title="statement not covered">  delete snapshot.newEvents;</span>
<span class="cstat-no" title="statement not covered">  delete snapshot.replaying;</span>
<span class="cstat-no" title="statement not covered">  delete snapshot._events;</span>
<span class="cstat-no" title="statement not covered">  delete snapshot._maxListeners;</span>
<span class="cstat-no" title="statement not covered">  delete snapshot.domain;</span>
<span class="cstat-no" title="statement not covered">  return snapshot;</span>
};
&nbsp;
/**
 * Helper function to automatically create a method that calls digest on the
 * param provided. Use it to add methods that automatically call digest.
 *
 * @param  {Object} type  the entity class to which the method will be added.
 * @param  {Function} fn  the actual function to be added.
 * @example
 *
 *    Entity.digestMethod(Car, function clearSettings (param) {
 *
 *     const self = this;
 *
 *     this.settings.get(param.name).forEach((name, config) =&gt; {
 *
 *       config.sources.forEach((source) =&gt; {
 *
 *         source.remove();
 *
 *       });
 *
 *     });
 *
 *     return this.settings;
 *
 *    });
 *
 */
Entity.digestMethod = <span class="fstat-no" title="function not covered">function (type, fn) {</span>
<span class="cstat-no" title="statement not covered">  if ( ! type) <span class="cstat-no" title="statement not covered">throw new EntityError('type is required for digest method definitions');</span></span>
<span class="cstat-no" title="statement not covered">  if ( ! fn) <span class="cstat-no" title="statement not covered">throw new EntityError('a function is required for digest method definitions');</span></span>
<span class="cstat-no" title="statement not covered">  if ( ! fn.name) <span class="cstat-no" title="statement not covered">throw new EntityError('Anonmyous functions are not allowed in digest method definitions. Please provide a function name');</span></span>
<span class="cstat-no" title="statement not covered">  type.prototype[fn.name] = <span class="fstat-no" title="function not covered">function () {</span></span>
<span class="cstat-no" title="statement not covered">    var digestArgs = Array.prototype.slice.call(arguments);</span>
<span class="cstat-no" title="statement not covered">    digestArgs.unshift(fn.name);</span>
<span class="cstat-no" title="statement not covered">    Entity.prototype.digest.apply(this, digestArgs);</span>
&nbsp;
<span class="cstat-no" title="statement not covered">    var methodArgs = Array.prototype.slice.call(arguments);</span>
<span class="cstat-no" title="statement not covered">    return fn.apply(this, methodArgs);</span>
  };
};
&nbsp;
/**
 * mergeProperties holds a map of entity types to properties.
 *
 * @see Entity.mergeProperty
 * @see Entity.prototype.mergeProperty
 * @static
 */
var mergeProperties = new Map();
&nbsp;
/**
 * Convenience function to store references to functions that should be run
 * when mergin a particular property.
 *
 * @param  {Object} type  the entity class to which the property-&gt;fn belongs to.
 * @param  {String} name  the name of the property that holds the fn.
 * @param  {Function} fn  the function to execute when merging the property.
 * @see mergeProperties
 * @example
 *  function Wheel (status) {
 *    this.status = status;
 *  }
 *
 *  Wheel.prototype.go = function () {
 *    this.status = 'going';
 *  }
 *
 *  function Car () {
 *    this.id = null;
 *    this.wheel = new Wheel(); // for instantiating our default wheel, when we first 'new' up a Car
 *
 *    Entity.apply(this, arguments);
 *  }
 *
 *  util.inherits(Car, Entity);
 *
 *  Entity.mergeProperty(Car, 'wheels', function (obj) {
 *    this.wheel = new Wheel(); // for instantiating our wheel from saved values in a database
 *  });
 */
Entity.mergeProperty = <span class="fstat-no" title="function not covered">function (type, name, fn) {</span>
<span class="cstat-no" title="statement not covered">  if ( ! mergeProperties.has(type.name)) <span class="cstat-no" title="statement not covered">mergeProperties.set(type.name, new Map());</span></span>
<span class="cstat-no" title="statement not covered">  mergeProperties.get(type.name).set(name, fn);</span>
};
&nbsp;
module.exports = Entity;
&nbsp;
&nbsp;</pre></td></tr>
</tbody></table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Sat Apr 22 2017 01:04:11 GMT+0000 (UTC)</div>
</div>


</body></html>